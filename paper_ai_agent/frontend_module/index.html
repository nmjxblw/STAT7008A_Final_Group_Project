<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI æŸ¥è¯¢åŠ©æ‰‹</title>

    <!-- Vue 3 CDN -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <!-- Marked.js CDN (Markdownæ¸²æŸ“) -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>

    <!-- Chart.js CDN (å›¾è¡¨æ¸²æŸ“) -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>

    <style>
        /* ========== å…¨å±€æ ·å¼ ========== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f5f5f5;
            height: 100vh;
            overflow: hidden;
        }

        /* ========== ä¸»å®¹å™¨ ========== */
        #app {
            height: 100vh;
            display: flex;
            flex-direction: column;
        }

        /* ========== é¡¶éƒ¨æ ‡é¢˜æ  ========== */
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            text-align: center;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 24px;
            font-weight: 600;
        }

        /* ========== å¯¹è¯åŒºåŸŸ ========== */
        .chat-container {
            flex: 1;
            overflow-y: auto;
            padding: 20px;
            background-color: #f5f5f5;
        }

        .chat-container::-webkit-scrollbar {
            width: 8px;
        }

        .chat-container::-webkit-scrollbar-track {
            background: #f1f1f1;
        }

        .chat-container::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }

        .chat-container::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        /* ========== æ¶ˆæ¯æ°”æ³¡ ========== */
        .message {
            margin-bottom: 20px;
            display: flex;
            animation: fadeIn 0.3s ease-in;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ç”¨æˆ·æ¶ˆæ¯ */
        .message.user {
            justify-content: flex-end;
        }

        .message.user .message-content {
            background-color: #e3f2fd;
            color: #1976d2;
            border-radius: 18px 18px 4px 18px;
            max-width: 70%;
        }

        /* AIæ¶ˆæ¯ */
        .message.ai {
            justify-content: flex-start;
        }

        .message.ai .message-content {
            background-color: white;
            border-radius: 18px 18px 18px 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            max-width: 85%;
        }

        .message-content {
            padding: 15px 20px;
        }

        .message-text {
            line-height: 1.6;
            word-wrap: break-word;
        }

        .message-time {
            font-size: 12px;
            color: #999;
            margin-top: 8px;
            text-align: right;
        }

        /* ========== æ–‡ä»¶åˆ—è¡¨åŒºåŸŸ ========== */
        .files-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .files-header {
            font-size: 14px;
            color: #666;
            margin-bottom: 12px;
            font-weight: 600;
        }

        .file-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #f9f9f9;
            border-radius: 8px;
            border: 2px solid #e0e0e0;
            transition: all 0.3s;
            cursor: pointer;
            position: relative;
        }

        .file-item:hover {
            background-color: #f0f0f0;
            border-color: #2196f3;
            transform: translateX(4px);
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.2);
        }

        /* é€‰ä¸­çŠ¶æ€ */
        .file-item.file-selected {
            background-color: #e3f2fd;
            border-color: #2196f3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.3);
        }

        .file-item.file-selected:hover {
            background-color: #bbdefb;
        }

        /* ç¦ç”¨çŠ¶æ€ */
        .file-item.file-disabled {
            cursor: not-allowed;
            opacity: 0.7;
        }

        .file-item.file-disabled:hover {
            transform: none;
            border-color: #e0e0e0;
            box-shadow: none;
        }

        .file-item input[type="checkbox"] {
            width: 18px;
            height: 18px;
            margin-right: 12px;
            cursor: pointer;
        }

        .file-icon {
            font-size: 20px;
            margin-right: 10px;
        }

        .file-info {
            flex: 1;
        }

        .file-name {
            font-size: 14px;
            color: #333;
            font-weight: 500;
        }

        .file-relevance {
            display: flex;
            align-items: center;
            margin-top: 5px;
        }

        .relevance-label {
            font-size: 12px;
            color: #666;
            margin-right: 8px;
        }

        .relevance-bar {
            flex: 1;
            height: 8px;
            background-color: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
            margin-right: 8px;
        }

        .relevance-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            transition: width 0.3s ease;
        }

        .relevance-percent {
            font-size: 12px;
            font-weight: 600;
            color: #4caf50;
            min-width: 40px;
        }

        /* æ–‡ä»¶æ‚¬æµ®è§¦å‘å™¨ */
        .file-hover-trigger {
            position: absolute;
            right: 10px;
            top: 10px;
            width: 24px;
            height: 24px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            cursor: help;
            transition: all 0.3s;
            z-index: 100; /* é™ä½å±‚çº§ï¼Œä¸é˜»æŒ¡æ‚¬æµ®æ¡† */
            pointer-events: all; /* ç¡®ä¿å¯ä»¥è§¦å‘hover */
        }

        .file-hover-trigger:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        /* Tooltipå®¹å™¨æ ·å¼ */
        #tooltip-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none; /* ä¸é˜»æŒ¡åº•å±‚ç‚¹å‡» */
            z-index: 10000;
        }

        .confirm-button {
            display: block;
            margin: 15px auto 0;
            padding: 10px 30px;
            background-color: #2196f3;
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 14px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .confirm-button:hover {
            background-color: #1976d2;
            transform: scale(1.05);
        }

        .confirm-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: scale(1);
        }

        /* ========== AIå›ç­”åŒºåŸŸ ========== */
        .ai-answer {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #e0e0e0;
        }

        .ai-answer-content {
            line-height: 1.8;
        }

        /* Markdownæ ·å¼ */
        .ai-answer-content h1,
        .ai-answer-content h2,
        .ai-answer-content h3 {
            margin-top: 16px;
            margin-bottom: 12px;
            color: #333;
        }

        .ai-answer-content h1 {
            font-size: 20px;
            border-bottom: 2px solid #2196f3;
            padding-bottom: 8px;
        }

        .ai-answer-content h2 {
            font-size: 18px;
        }

        .ai-answer-content h3 {
            font-size: 16px;
        }

        .ai-answer-content p {
            margin-bottom: 12px;
            color: #555;
            position: relative;
        }

        .ai-answer-content ul,
        .ai-answer-content ol {
            margin-left: 20px;
            margin-bottom: 12px;
        }

        .ai-answer-content li {
            margin-bottom: 6px;
            color: #555;
        }

        .ai-answer-content code {
            background-color: #f5f5f5;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }

        .ai-answer-content pre {
            background-color: #f5f5f5;
            padding: 12px;
            border-radius: 6px;
            overflow-x: auto;
            margin-bottom: 12px;
        }

        /* æ‚¬åœæ ‡ç­¾æ ·å¼ - æ”¾åœ¨æ®µè½å³ä¾§ */
        .paragraph-wrapper {
            position: relative;
            margin-bottom: 12px;
        }

        .hover-tag {
            position: absolute;
            right: 0;
            top: 0;
            padding: 4px 10px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            font-size: 11px;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: all 0.3s;
            z-index: 100; /* é™ä½å±‚çº§ */
            pointer-events: all;
        }

        .hover-tag:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        /* æ‚¬åœå¡ç‰‡ - æ”¯æŒå¤šç§æ•°æ®ç±»å‹ */
        .hover-tooltip {
            position: fixed; /* æ”¹ä¸ºfixedå®šä½ */
            background-color: white;
            border: 1px solid #e0e0e0;
            border-radius: 12px;
            padding: 0;
            width: 400px;
            max-width: 90vw;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s, visibility 0.3s;
            overflow: hidden;
            pointer-events: auto; /* æ‚¬æµ®æ¡†å¯ä»¥äº¤äº’ */
        }

        .hover-tooltip.visible {
            visibility: visible;
            opacity: 1;
        }

        /* æ‚¬åœå¡ç‰‡å¤´éƒ¨ */
        .tooltip-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 15px;
            font-size: 13px;
            font-weight: 600;
            border-bottom: 1px solid rgba(255,255,255,0.2);
        }

        /* æ‚¬åœå¡ç‰‡å†…å®¹ */
        .tooltip-content {
            padding: 15px;
            max-height: 450px;
            overflow-y: auto;
        }

        .tooltip-content::-webkit-scrollbar {
            width: 6px;
        }

        .tooltip-content::-webkit-scrollbar-thumb {
            background: #ccc;
            border-radius: 3px;
        }

        /* æ•°æ®é¡¹æ ·å¼ */
        .tooltip-item {
            margin-bottom: 12px;
            padding-bottom: 12px;
            border-bottom: 1px solid #f0f0f0;
        }

        .tooltip-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        .tooltip-label {
            font-size: 11px;
            color: #999;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .tooltip-value {
            font-size: 13px;
            color: #333;
            line-height: 1.6;
        }

        /* å›¾è¡¨/æ•°æ®å¯è§†åŒ–å®¹å™¨ */
        .tooltip-chart {
            background-color: #f9f9f9;
            padding: 12px;
            border-radius: 8px;
            margin-top: 8px;
            position: relative;
            min-height: 200px;
        }

        .tooltip-chart canvas {
            max-height: 250px;
        }

        /* å›¾ç‰‡æ ·å¼(å¤‡ç”¨) */
        .tooltip-image {
            width: 100%;
            border-radius: 8px;
            margin-top: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        /* åˆ—è¡¨æ ·å¼ */
        .tooltip-list {
            list-style: none;
            padding: 0;
            margin: 8px 0 0 0;
        }

        .tooltip-list li {
            padding: 6px 0;
            font-size: 13px;
            color: #555;
            border-bottom: 1px solid #f5f5f5;
        }

        .tooltip-list li:last-child {
            border-bottom: none;
        }

        .tooltip-list li::before {
            content: "â€¢";
            color: #2196f3;
            font-weight: bold;
            display: inline-block;
            width: 1em;
            margin-left: -1em;
        }

        /* æ ‡ç­¾æ ·å¼ */
        .tooltip-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
            margin-top: 8px;
        }

        .tooltip-tag {
            background-color: #e3f2fd;
            color: #2196f3;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 11px;
            font-weight: 500;
        }

        /* ç»Ÿè®¡æ•°æ®æ ·å¼ */
        .tooltip-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            margin-top: 8px;
        }

        .stat-item {
            background-color: #f9f9f9;
            padding: 10px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-value {
            font-size: 18px;
            font-weight: 700;
            color: #2196f3;
            margin-bottom: 4px;
        }

        .stat-label {
            font-size: 11px;
            color: #666;
        }

        /* é“¾æ¥æ ·å¼ */
        .tooltip-link {
            color: #2196f3;
            text-decoration: none;
            font-weight: 500;
            transition: color 0.2s;
        }

        .tooltip-link:hover {
            color: #1976d2;
            text-decoration: underline;
        }

        /* ========== åŠ è½½çŠ¶æ€ ========== */
        .loading {
            display: flex;
            align-items: center;
            gap: 8px;
            color: #666;
            font-size: 14px;
        }

        .loading-spinner {
            width: 16px;
            height: 16px;
            border: 2px solid #e0e0e0;
            border-top: 2px solid #2196f3;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* ========== è¾“å…¥åŒºåŸŸ ========== */
        .input-container {
            background-color: white;
            border-top: 1px solid #e0e0e0;
            padding: 20px;
            box-shadow: 0 -2px 8px rgba(0,0,0,0.05);
        }

        .input-wrapper {
            display: flex;
            gap: 10px;
            margin-bottom: 12px;
        }

        .input-wrapper textarea {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 24px;
            font-size: 14px;
            font-family: inherit;
            resize: none;
            outline: none;
            transition: border-color 0.2s;
        }

        .input-wrapper textarea:focus {
            border-color: #2196f3;
        }

        .send-button {
            padding: 12px 30px;
            background-color: #2196f3;
            color: white;
            border: none;
            border-radius: 24px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s;
            white-space: nowrap;
        }

        .send-button:hover:not(:disabled) {
            background-color: #1976d2;
            transform: scale(1.05);
        }

        .send-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: scale(1);
        }

        /* ========== åº•éƒ¨æŒ‰é’®ç»„ ========== */
        .action-buttons {
            display: flex;
            gap: 12px;
        }

        .action-button {
            padding: 8px 20px;
            background-color: white;
            color: #666;
            border: 1px solid #e0e0e0;
            border-radius: 20px;
            font-size: 13px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .action-button:hover {
            background-color: #f5f5f5;
            border-color: #2196f3;
            color: #2196f3;
        }

        .action-button.terminate {
            color: #f44336;
        }

        .action-button.terminate:hover {
            border-color: #f44336;
            background-color: #ffebee;
        }

        .action-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ========== å“åº”å¼è®¾è®¡ ========== */
        @media (max-width: 768px) {
            .message.user .message-content,
            .message.ai .message-content {
                max-width: 90%;
            }

            .input-wrapper {
                flex-direction: column;
            }

            .send-button {
                width: 100%;
            }

            .action-buttons {
                flex-direction: column;
            }

            .action-button {
                width: 100%;
            }
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- é¡¶éƒ¨æ ‡é¢˜ -->
        <div class="header">
            <h1>ğŸ¤– AI æŸ¥è¯¢åŠ©æ‰‹</h1>
        </div>

        <!-- å¯¹è¯åŒºåŸŸ -->
        <div class="chat-container" ref="chatContainer">
            <!-- æ¶ˆæ¯åˆ—è¡¨ -->
            <div v-for="(message, index) in messages" :key="index" :class="['message', message.type]">
                <div class="message-content">
                    <!-- ç”¨æˆ·æ¶ˆæ¯ -->
                    <div v-if="message.type === 'user'" class="message-text">
                        {{ message.text }}
                    </div>

                    <!-- AIæ¶ˆæ¯ -->
                    <div v-if="message.type === 'ai'">
                        <!-- åŠ è½½çŠ¶æ€ -->
                        <div v-if="message.status === 'searching'" class="loading">
                            <div class="loading-spinner"></div>
                            <span>æ­£åœ¨å¯»æ‰¾æ–‡çŒ®...</span>
                        </div>

                        <!-- æ–‡ä»¶åˆ—è¡¨ -->
                        <div v-if="message.status === 'files' || message.status === 'thinking' || message.status === 'done'" class="files-section">
                            <div class="files-header">ğŸ“„ ç›¸å…³æ–‡ä»¶ï¼š</div>
                            <div
                                v-for="file in message.files"
                                :key="file.id"
                                class="file-item"
                                :class="{ 'file-selected': file.selected, 'file-disabled': message.status !== 'files' }"
                                @click="toggleFileSelection(file, message)"
                            >
                                <input
                                    type="checkbox"
                                    :id="'file-' + file.id"
                                    v-model="file.selected"
                                    :disabled="message.status !== 'files'"
                                    @click.stop
                                >
                                <span class="file-icon">{{ getFileIcon(file.type) }}</span>
                                <div class="file-info">
                                    <div class="file-name">{{ file.name }}</div>
                                    <div class="file-relevance">
                                        <span class="relevance-label">ç›¸å…³åº¦:</span>
                                        <div class="relevance-bar">
                                            <div class="relevance-fill" :style="{ width: (file.relevance * 100) + '%' }"></div>
                                        </div>
                                        <span class="relevance-percent">{{ Math.round(file.relevance * 100) }}%</span>
                                    </div>
                                </div>

                                <!-- æ–‡ä»¶æ‚¬æµ®æç¤º -->
                                <div class="file-hover-trigger" @click.stop>â„¹ï¸
                                    <tooltip-card
                                        title="ğŸ“„ æ–‡ä»¶è¯¦æƒ…"
                                        :data="buildFileTooltipData(file)"
                                        position="left"
                                    ></tooltip-card>
                                </div>
                            </div>

                            <!-- ç¡®è®¤æŒ‰é’® -->
                            <button
                                v-if="message.status === 'files'"
                                class="confirm-button"
                                @click="confirmFiles(message)"
                                :disabled="!hasSelectedFiles(message)"
                            >
                                ç¡®è®¤é€‰æ‹©
                            </button>
                        </div>

                        <!-- æ€è€ƒä¸­ -->
                        <div v-if="message.status === 'thinking'" class="loading" style="margin-top: 15px;">
                            <div class="loading-spinner"></div>
                            <span>æ­£åœ¨æ€è€ƒ...</span>
                        </div>

                        <!-- AIå›ç­” -->
                        <div v-if="message.status === 'done' && message.answer" class="ai-answer">
                            <div class="ai-answer-content">
                                <answer-with-sources
                                    :markdown="message.answer"
                                    :sources="message.answerSources">
                                </answer-with-sources>
                            </div>
                        </div>
                    </div>

                    <!-- æ—¶é—´æˆ³ -->
                    <div class="message-time">{{ message.time }}</div>
                </div>
            </div>
        </div>

        <!-- æ‚¬æµ®æ¡†å®¹å™¨ (ç”¨äºTeleport) -->
        <div id="tooltip-container"></div>

        <!-- è¾“å…¥åŒºåŸŸ -->
        <div class="input-container">
            <div class="input-wrapper">
                <textarea
                    v-model="userInput"
                    placeholder="è¯·è¾“å…¥æ‚¨çš„é—®é¢˜..."
                    rows="2"
                    @keydown.enter.exact.prevent="sendMessage"
                    @keydown.shift.enter="handleShiftEnter"
                    :disabled="isProcessing"
                ></textarea>
                <button
                    class="send-button"
                    @click="sendMessage"
                    :disabled="!userInput.trim() || isProcessing"
                >
                    {{ isProcessing ? 'å‘é€ä¸­...' : 'å‘é€' }}
                </button>
            </div>

            <div class="action-buttons">
                <button
                    class="action-button terminate"
                    @click="terminateTask"
                    :disabled="!isProcessing"
                >
                    ğŸ›‘ ç»ˆæ­¢ä»»åŠ¡
                </button>
                <button class="action-button" @click="exportToExcel">
                    ğŸ“Š å¯¼å‡º Excel
                </button>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;

        // ========== é…ç½® ==========
        const CONFIG = {
            USE_MOCK: true,        // æ˜¯å¦ä½¿ç”¨Mockæ•°æ®
            MOCK_DELAY: 1500,      // Mockå»¶è¿Ÿæ—¶é—´(æ¯«ç§’)
            API_URL: ''            // çœŸå®APIåœ°å€(æš‚æ—¶ä¸ç”¨)
        };

        // ========== å¯å¤ç”¨çš„æ‚¬æµ®æç¤ºç»„ä»¶ ==========
        const TooltipCard = {
            name: 'TooltipCard',
            props: {
                title: {
                    type: String,
                    required: true
                },
                data: {
                    type: Object,
                    required: true
                },
                position: {
                    type: String,
                    default: 'right' // 'left', 'right', 'top', 'bottom'
                }
            },
            data() {
                return {
                    isVisible: false,
                    tooltipStyle: {
                        top: '0px',
                        left: '0px'
                    },
                    chartInstance: null,
                    chartId: `chart-${Math.random().toString(36).substr(2, 9)}`
                };
            },
            mounted() {
                // ç›‘å¬è§¦å‘å™¨çš„é¼ æ ‡äº‹ä»¶
                const trigger = this.$refs.placeholder?.parentElement;
                if (trigger) {
                    trigger.addEventListener('mouseenter', this.showTooltip);
                    trigger.addEventListener('mouseleave', this.hideTooltip);
                }
            },
            beforeUnmount() {
                const trigger = this.$refs.placeholder?.parentElement;
                if (trigger) {
                    trigger.removeEventListener('mouseenter', this.showTooltip);
                    trigger.removeEventListener('mouseleave', this.hideTooltip);
                }
                // é”€æ¯å›¾è¡¨å®ä¾‹
                if (this.chartInstance) {
                    this.chartInstance.destroy();
                }
            },
            watch: {
                isVisible(newVal) {
                    // å½“æ‚¬æµ®æ¡†å˜ä¸ºå¯è§æ—¶,æ¸²æŸ“å›¾è¡¨
                    if (newVal && this.data.chartData && !this.chartInstance) {
                        this.$nextTick(() => {
                            this.renderChart();
                        });
                    }
                }
            },
            methods: {
                showTooltip() {
                    this.calculatePosition();
                    this.isVisible = true;
                },
                hideTooltip() {
                    this.isVisible = false;
                    // ä¸ç«‹å³é”€æ¯å›¾è¡¨ï¼Œè®©å®ƒä¿ç•™åœ¨å†…å­˜ä¸­
                    // ä¸‹æ¬¡æ˜¾ç¤ºæ—¶ä¼šæ£€æŸ¥æ˜¯å¦å·²å­˜åœ¨ï¼Œé¿å…é‡å¤åˆ›å»º
                },
                renderChart() {
                    if (!this.data.chartData || this.chartInstance) return;

                    // å¤šæ¬¡å°è¯•è·å– canvas,å› ä¸º DOM å¯èƒ½è¿˜æ²¡å‡†å¤‡å¥½
                    const tryRender = (attempts = 0) => {
                        if (attempts > 10) return;

                        const canvas = document.getElementById(this.chartId);
                        if (!canvas) {
                            setTimeout(() => tryRender(attempts + 1), 50);
                            return;
                        }

                        try {
                            const ctx = canvas.getContext('2d');
                            const chartData = this.data.chartData;

                            // åˆ›å»ºå›¾è¡¨
                            this.chartInstance = new Chart(ctx, {
                                type: chartData.type || 'bar',
                                data: {
                                    labels: chartData.labels || [],
                                    datasets: chartData.datasets || []
                                },
                                options: {
                                    responsive: true,
                                    maintainAspectRatio: true,
                                    animation: false, // ç¦ç”¨åŠ¨ç”»ï¼Œé¿å…é”€æ¯æ—¶çš„é”™è¯¯
                                    plugins: {
                                        legend: {
                                            display: chartData.showLegend !== false,
                                            position: 'top'
                                        },
                                        title: {
                                            display: !!chartData.title,
                                            text: chartData.title || ''
                                        }
                                    },
                                    scales: chartData.type === 'pie' || chartData.type === 'doughnut' ? {} : {
                                        y: {
                                            beginAtZero: true
                                        }
                                    }
                                }
                            });
                        } catch (error) {
                            // é™é»˜å¤±è´¥
                        }
                    };

                    tryRender();
                },
                calculatePosition() {
                    const trigger = this.$refs.placeholder?.parentElement;
                    if (!trigger) return;

                    const triggerRect = trigger.getBoundingClientRect();
                    const tooltipWidth = 400; // æ‚¬æµ®æ¡†å®½åº¦
                    const tooltipMaxHeight = 500; // æœ€å¤§é«˜åº¦(åŒ…å«å†…å®¹æ»šåŠ¨)
                    const gap = 10; // é—´è·
                    const edgePadding = 20; // è¾¹ç¼˜å®‰å…¨è·ç¦»

                    let top = 0;
                    let left = 0;

                    switch (this.position) {
                        case 'left':
                            top = triggerRect.top;
                            left = triggerRect.left - tooltipWidth - gap;
                            // é˜²æ­¢è¶…å‡ºå·¦è¾¹ç•Œ
                            if (left < 0) {
                                left = triggerRect.right + gap;
                            }
                            // é˜²æ­¢è¶…å‡ºä¸‹è¾¹ç•Œ
                            if (top + tooltipMaxHeight > window.innerHeight - edgePadding) {
                                top = window.innerHeight - tooltipMaxHeight - edgePadding;
                            }
                            // é˜²æ­¢è¶…å‡ºä¸Šè¾¹ç•Œ
                            top = Math.max(edgePadding, top);
                            break;
                        case 'right':
                            top = triggerRect.top;
                            left = triggerRect.right + gap;
                            // é˜²æ­¢è¶…å‡ºå³è¾¹ç•Œ
                            if (left + tooltipWidth > window.innerWidth - edgePadding) {
                                left = triggerRect.left - tooltipWidth - gap;
                            }
                            // é˜²æ­¢è¶…å‡ºä¸‹è¾¹ç•Œ
                            if (top + tooltipMaxHeight > window.innerHeight - edgePadding) {
                                top = window.innerHeight - tooltipMaxHeight - edgePadding;
                            }
                            // é˜²æ­¢è¶…å‡ºä¸Šè¾¹ç•Œ
                            top = Math.max(edgePadding, top);
                            break;
                        case 'top':
                            top = triggerRect.top - tooltipMaxHeight - gap;
                            left = triggerRect.left;
                            // é˜²æ­¢è¶…å‡ºä¸Šè¾¹ç•Œ
                            if (top < edgePadding) {
                                top = triggerRect.bottom + gap;
                            }
                            break;
                        case 'bottom':
                        default:
                            top = triggerRect.bottom + gap;
                            left = triggerRect.left;
                            // é˜²æ­¢è¶…å‡ºä¸‹è¾¹ç•Œ
                            if (top + tooltipMaxHeight > window.innerHeight - edgePadding) {
                                top = triggerRect.top - tooltipMaxHeight - gap;
                                // å¦‚æœä¸Šæ–¹ä¹Ÿæ”¾ä¸ä¸‹,å°±ç´§è´´ä¸‹è¾¹ç•Œ
                                if (top < edgePadding) {
                                    top = window.innerHeight - tooltipMaxHeight - edgePadding;
                                }
                            }
                            break;
                    }

                    // æœ€ç»ˆç¡®ä¿ä¸è¶…å‡ºè§†å£(åŒé‡ä¿é™©)
                    top = Math.max(edgePadding, Math.min(top, window.innerHeight - tooltipMaxHeight - edgePadding));
                    left = Math.max(edgePadding, Math.min(left, window.innerWidth - tooltipWidth - edgePadding));

                    this.tooltipStyle = {
                        top: `${top}px`,
                        left: `${left}px`
                    };
                }
            },
            template: `
                <span style="display: none;" ref="placeholder"></span>
                <teleport to="#tooltip-container">
                    <div
                        class="hover-tooltip"
                        :class="{ visible: isVisible }"
                        :style="tooltipStyle"
                        @mouseenter="isVisible = true"
                        @mouseleave="hideTooltip"
                    >
                    <div class="tooltip-header">{{ title }}</div>
                    <div class="tooltip-content">
                        <!-- é€šç”¨æ–‡æœ¬å­—æ®µ -->
                        <div v-if="data.text" class="tooltip-item">
                            <div class="tooltip-value">{{ data.text }}</div>
                        </div>

                        <!-- æ¥æº/å¼•ç”¨ -->
                        <div v-if="data.source" class="tooltip-item">
                            <div class="tooltip-label">å¼•ç”¨æ–‡çŒ®</div>
                            <div class="tooltip-value">{{ data.source }}</div>
                        </div>

                        <!-- æè¿° -->
                        <div v-if="data.description" class="tooltip-item">
                            <div class="tooltip-label">æè¿°</div>
                            <div class="tooltip-value">{{ data.description }}</div>
                        </div>

                        <!-- ç»Ÿè®¡æ•°æ® -->
                        <div v-if="data.stats && data.stats.length > 0" class="tooltip-item">
                            <div class="tooltip-label">{{ data.statsLabel || 'ç»Ÿè®¡ä¿¡æ¯' }}</div>
                            <div class="tooltip-stats">
                                <div v-for="(stat, idx) in data.stats" :key="idx" class="stat-item">
                                    <div class="stat-value">{{ stat.value }}</div>
                                    <div class="stat-label">{{ stat.label }}</div>
                                </div>
                            </div>
                        </div>

                        <!-- åˆ—è¡¨æ•°æ® -->
                        <div v-if="data.list && data.list.length > 0" class="tooltip-item">
                            <div class="tooltip-label">{{ data.listLabel || 'è¯¦ç»†ä¿¡æ¯' }}</div>
                            <ul class="tooltip-list">
                                <li v-for="(item, idx) in data.list" :key="idx">{{ item }}</li>
                            </ul>
                        </div>

                        <!-- æ ‡ç­¾ -->
                        <div v-if="data.tags && data.tags.length > 0" class="tooltip-item">
                            <div class="tooltip-label">{{ data.tagsLabel || 'æ ‡ç­¾' }}</div>
                            <div class="tooltip-tags">
                                <span v-for="(tag, idx) in data.tags" :key="idx" class="tooltip-tag">{{ tag }}</span>
                            </div>
                        </div>

                        <!-- å…ƒæ•°æ® -->
                        <div v-if="data.metadata" class="tooltip-item">
                            <div class="tooltip-label">{{ data.metadataLabel || 'å…ƒæ•°æ®' }}</div>
                            <div class="tooltip-value">{{ data.metadata }}</div>
                        </div>

                        <!-- å›¾è¡¨ -->
                        <div v-if="data.chartData" class="tooltip-item">
                            <div class="tooltip-label">{{ data.chartLabel || 'æ•°æ®å¯è§†åŒ–' }}</div>
                            <div class="tooltip-chart">
                                <canvas :id="chartId"></canvas>
                            </div>
                        </div>

                        <!-- å›¾ç‰‡(å¤‡ç”¨,å¦‚æœæ²¡æœ‰chartDataä½†æœ‰image) -->
                        <div v-else-if="data.image" class="tooltip-item">
                            <div class="tooltip-label">{{ data.imageLabel || 'ç›¸å…³å›¾è¡¨' }}</div>
                            <img :src="data.image" class="tooltip-image" :alt="data.imageLabel || 'å›¾ç‰‡'">
                        </div>
                    </div>
                    </div>
                </teleport>
            `
        };

        // ========== AIå›ç­”æ®µè½ç»„ä»¶ ==========
        const AnswerWithSources = {
            name: 'AnswerWithSources',
            props: {
                markdown: {
                    type: String,
                    required: true
                },
                sources: {
                    type: Array,
                    default: () => []
                }
            },
            data() {
                return {
                    paragraphs: []
                };
            },
            mounted() {
                this.parseParagraphs();
            },
            watch: {
                markdown() {
                    this.parseParagraphs();
                }
            },
            methods: {
                parseParagraphs() {
                    if (!this.markdown) {
                        this.paragraphs = [];
                        return;
                    }

                    // ä½¿ç”¨markedæ¸²æŸ“Markdown
                    let html = marked.parse(this.markdown);

                    // å°†HTMLåˆ†æ®µ
                    const segments = html.split('</h1>').join('</h1>|||SPLIT|||')
                                        .split('</h2>').join('</h2>|||SPLIT|||')
                                        .split('</h3>').join('</h3>|||SPLIT|||')
                                        .split('</p>').join('</p>|||SPLIT|||')
                                        .split('</ul>').join('</ul>|||SPLIT|||')
                                        .split('</ol>').join('</ol>|||SPLIT|||')
                                        .split('|||SPLIT|||')
                                        .filter(p => p.trim());

                    // ä¸ºæ¯ä¸ªæ®µè½å…³è”æ¥æºæ•°æ®
                    this.paragraphs = segments.map((html, index) => ({
                        html,
                        source: this.sources && this.sources[index] ? this.sources[index] : null
                    }));
                },
                buildSourceTooltipData(source) {
                    if (!source) return null;

                    const data = {
                        source: source.source,
                        tags: source.tags,
                        tagsLabel: 'æ ‡ç­¾',
                        list: source.quotes,
                        listLabel: 'å…³é”®å¼•ç”¨',
                        url: source.url,
                        urlLabel: 'è¯¦ç»†ä¿¡æ¯',
                        urlText: 'æŸ¥çœ‹åŸæ–‡ â†’'
                    };

                    // æ„å»ºç»Ÿè®¡æ•°æ®
                    if (source.confidence || source.citations) {
                        data.stats = [];
                        data.statsLabel = 'å¯ä¿¡åº¦';

                        if (source.confidence) {
                            data.stats.push({
                                value: Math.round(source.confidence * 100) + '%',
                                label: 'ç½®ä¿¡åº¦'
                            });
                        }

                        if (source.citations) {
                            data.stats.push({
                                value: source.citations,
                                label: 'å¼•ç”¨æ¬¡æ•°'
                            });
                        }
                    }

                    // æ„å»ºå›¾è¡¨æ•°æ®(ç¤ºä¾‹:å¼•ç”¨è¶‹åŠ¿)
                    if (source.citationTrend) {
                        data.chartData = {
                            type: 'line',
                            title: 'å¼•ç”¨è¶‹åŠ¿',
                            labels: source.citationTrend.years,
                            datasets: [{
                                label: 'å¹´åº¦å¼•ç”¨æ¬¡æ•°',
                                data: source.citationTrend.counts,
                                borderColor: 'rgb(102, 126, 234)',
                                backgroundColor: 'rgba(102, 126, 234, 0.1)',
                                tension: 0.3,
                                fill: true
                            }]
                        };
                        data.chartLabel = 'å¼•ç”¨è¶‹åŠ¿åˆ†æ';
                    }

                    return data;
                }
            },
            components: {
                'tooltip-card': TooltipCard
            },
            template: `
                <div>
                    <div v-for="(para, index) in paragraphs" :key="index" class="paragraph-wrapper">
                        <div v-html="para.html"></div>
                        <span v-if="para.source" class="hover-tag">
                            ğŸ“š æ¥æº
                            <tooltip-card
                                title="ğŸ“š æ•°æ®æ¥æº"
                                :data="buildSourceTooltipData(para.source)"
                                position="right">
                            </tooltip-card>
                        </span>
                    </div>
                </div>
            `
        };

        // ========== Mock æ•°æ® ==========
        const MOCK_DATA = [
            {
                question: "ä»€ä¹ˆæ˜¯äººå·¥æ™ºèƒ½?",
                files: [
                    {
                        id: 1,
                        name: "AIå‘å±•å².pdf",
                        type: "pdf",
                        relevance: 0.95,
                        matchScore: 9.5,
                        description: "è¯¦ç»†ä»‹ç»äº†äººå·¥æ™ºèƒ½ä»1950å¹´ä»£è‡³ä»Šçš„å‘å±•å†ç¨‹,åŒ…æ‹¬å…³é”®é‡Œç¨‹ç¢‘å’ŒæŠ€æœ¯çªç ´ã€‚",
                        keywords: ["äººå·¥æ™ºèƒ½", "å†å²", "å›¾çµæµ‹è¯•", "ä¸“å®¶ç³»ç»Ÿ", "æ·±åº¦å­¦ä¹ "],
                        summary: [
                            "å›é¡¾AIä»1956å¹´è¾¾ç‰¹èŒ…æ–¯ä¼šè®®çš„è¯ç”Ÿ",
                            "ä»‹ç»ä¸‰æ¬¡AIæµªæ½®å’Œå¯’å†¬æœŸ",
                            "åˆ†ææ·±åº¦å­¦ä¹ å¸¦æ¥çš„çªç ´"
                        ],
                        author: "John McCarthy ç­‰",
                        year: 2020,
                        pages: 350
                    },
                    {
                        id: 2,
                        name: "æœºå™¨å­¦ä¹ å…¥é—¨.docx",
                        type: "docx",
                        relevance: 0.87,
                        matchScore: 8.7,
                        description: "æ¶µç›–æœºå™¨å­¦ä¹ çš„åŸºç¡€æ¦‚å¿µã€ç®—æ³•åˆ†ç±»å’Œåº”ç”¨åœºæ™¯ã€‚",
                        keywords: ["æœºå™¨å­¦ä¹ ", "ç›‘ç£å­¦ä¹ ", "æ— ç›‘ç£å­¦ä¹ ", "ç®—æ³•"],
                        summary: [
                            "æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µå’Œå®šä¹‰",
                            "å¸¸è§ç®—æ³•åˆ†ç±»å’Œåº”ç”¨åœºæ™¯",
                            "æ¨¡å‹è¯„ä¼°å’Œä¼˜åŒ–æ–¹æ³•"
                        ],
                        author: "Andrew Ng",
                        year: 2019,
                        pages: 180
                    },
                    {
                        id: 3,
                        name: "æ·±åº¦å­¦ä¹ åŸç†.pdf",
                        type: "pdf",
                        relevance: 0.82,
                        matchScore: 8.2,
                        description: "æ·±å…¥è®²è§£ç¥ç»ç½‘ç»œã€å·ç§¯ç¥ç»ç½‘ç»œå’Œå¾ªç¯ç¥ç»ç½‘ç»œçš„åŸç†ã€‚",
                        keywords: ["æ·±åº¦å­¦ä¹ ", "ç¥ç»ç½‘ç»œ", "CNN", "RNN", "åå‘ä¼ æ’­"],
                        summary: [
                            "ç¥ç»ç½‘ç»œçš„æ•°å­¦åŸºç¡€",
                            "CNNåœ¨è®¡ç®—æœºè§†è§‰ä¸­çš„åº”ç”¨",
                            "RNNå¤„ç†åºåˆ—æ•°æ®çš„æ–¹æ³•"
                        ],
                        author: "Ian Goodfellow",
                        year: 2021,
                        pages: 520
                    },
                    {
                        id: 4,
                        name: "AIä¼¦ç†ä¸æŒ‘æˆ˜.docx",
                        type: "docx",
                        relevance: 0.75,
                        matchScore: 7.5,
                        description: "æ¢è®¨äººå·¥æ™ºèƒ½å‘å±•ä¸­çš„ä¼¦ç†é—®é¢˜ã€éšç§ä¿æŠ¤å’Œç¤¾ä¼šå½±å“ã€‚",
                        keywords: ["AIä¼¦ç†", "éšç§", "åè§", "è´£ä»»"],
                        summary: [
                            "AIç³»ç»Ÿçš„åè§å’Œå…¬å¹³æ€§é—®é¢˜",
                            "æ•°æ®éšç§å’Œå®‰å…¨æŒ‘æˆ˜",
                            "AIå¯¹å°±ä¸šå¸‚åœºçš„å½±å“"
                        ],
                        author: "Kate Crawford",
                        year: 2022,
                        pages: 240
                    },
                    {
                        id: 5,
                        name: "è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯.pdf",
                        type: "pdf",
                        relevance: 0.68,
                        matchScore: 6.8,
                        description: "ä»‹ç»NLPçš„æ ¸å¿ƒæŠ€æœ¯,åŒ…æ‹¬è¯å‘é‡ã€åºåˆ—æ¨¡å‹å’ŒTransformeræ¶æ„ã€‚",
                        keywords: ["NLP", "Transformer", "BERT", "GPT", "è¯å‘é‡"],
                        summary: [
                            "è¯å‘é‡è¡¨ç¤ºå’ŒWord2VecåŸç†",
                            "Transformeræ¶æ„çš„åˆ›æ–°",
                            "é¢„è®­ç»ƒæ¨¡å‹çš„åº”ç”¨"
                        ],
                        author: "Yoshua Bengio",
                        year: 2021,
                        pages: 420
                    }
                ],
                answer: `# äººå·¥æ™ºèƒ½ç®€ä»‹

äººå·¥æ™ºèƒ½(Artificial Intelligence, AI)æ˜¯è®¡ç®—æœºç§‘å­¦çš„ä¸€ä¸ªåˆ†æ”¯,è‡´åŠ›äºåˆ›å»ºèƒ½å¤Ÿæ¨¡æ‹Ÿã€å»¶ä¼¸å’Œæ‰©å±•äººç±»æ™ºèƒ½çš„ç³»ç»Ÿã€‚

## æ ¸å¿ƒæ¦‚å¿µ

AIçš„ç›®æ ‡æ˜¯ä½¿æœºå™¨èƒ½å¤Ÿæ‰§è¡Œé€šå¸¸éœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡,å¦‚è§†è§‰æ„ŸçŸ¥ã€è¯­éŸ³è¯†åˆ«ã€å†³ç­–åˆ¶å®šå’Œè¯­è¨€ç¿»è¯‘ç­‰ã€‚

## ä¸»è¦åº”ç”¨é¢†åŸŸ

1. **è®¡ç®—æœºè§†è§‰** - å›¾åƒè¯†åˆ«ã€äººè„¸è¯†åˆ«ã€è‡ªåŠ¨é©¾é©¶
2. **è‡ªç„¶è¯­è¨€å¤„ç†** - æœºå™¨ç¿»è¯‘ã€æƒ…æ„Ÿåˆ†æã€æ™ºèƒ½å®¢æœ
3. **æœºå™¨äººæŠ€æœ¯** - å·¥ä¸šè‡ªåŠ¨åŒ–ã€æœåŠ¡æœºå™¨äºº
4. **æ¨èç³»ç»Ÿ** - ä¸ªæ€§åŒ–æ¨èã€ç²¾å‡†è¥é”€

## å‘å±•è¶‹åŠ¿

éšç€æ·±åº¦å­¦ä¹ æŠ€æœ¯çš„çªç ´,AIæ­£åœ¨å¿«é€Ÿå‘å±•å¹¶æ·±å…¥åˆ°å„ä¸ªè¡Œä¸š,æ”¹å˜ç€æˆ‘ä»¬çš„ç”Ÿæ´»å’Œå·¥ä½œæ–¹å¼ã€‚`,
                answerSources: [
                    {
                        paragraph: 0,
                        source: "æ¥æº: AIå‘å±•å².pdf, ç¬¬12-15é¡µ",
                        confidence: 0.95,
                        citations: 1250,
                        tags: ["äººå·¥æ™ºèƒ½", "å†å²", "åŸºç¡€æ¦‚å¿µ"],
                        quotes: [
                            "AIèµ·æºäº1956å¹´è¾¾ç‰¹èŒ…æ–¯ä¼šè®®",
                            "å›¾çµæµ‹è¯•æ˜¯è¯„ä¼°AIçš„ç»å…¸æ ‡å‡†"
                        ],
                        citationTrend: {
                            years: ['2018', '2019', '2020', '2021', '2022', '2023'],
                            counts: [180, 245, 320, 485, 720, 1250]
                        },
                        url: "#"
                    },
                    {
                        paragraph: 1,
                        source: "æ¥æº: æœºå™¨å­¦ä¹ å…¥é—¨.docx, ç¬¬3ç« ",
                        confidence: 0.92,
                        citations: 856,
                        tags: ["æ ¸å¿ƒæ¦‚å¿µ", "å®šä¹‰"],
                        quotes: [
                            "AIç³»ç»Ÿèƒ½å¤Ÿæ‰§è¡Œéœ€è¦äººç±»æ™ºèƒ½çš„ä»»åŠ¡"
                        ]
                    },
                    {
                        paragraph: 2,
                        source: "æ¥æº: AIå‘å±•å².pdf, ç¬¬28-35é¡µ; è‡ªç„¶è¯­è¨€å¤„ç†æŠ€æœ¯.pdf, ç¬¬5ç« ",
                        confidence: 0.88,
                        citations: 2341,
                        tags: ["åº”ç”¨é¢†åŸŸ", "æŠ€æœ¯åˆ†ç±»", "è®¡ç®—æœºè§†è§‰", "NLP"],
                        quotes: [
                            "CVæŠ€æœ¯åœ¨è‡ªåŠ¨é©¾é©¶ä¸­è‡³å…³é‡è¦",
                            "NLPæ¨åŠ¨äº†æ™ºèƒ½å®¢æœçš„å‘å±•",
                            "æ¨èç³»ç»Ÿæ”¹å˜äº†ç”µå•†è¡Œä¸š"
                        ],
                        citationTrend: {
                            years: ['2018', '2019', '2020', '2021', '2022', '2023'],
                            counts: [320, 580, 890, 1240, 1780, 2341]
                        },
                        url: "#"
                    },
                    {
                        paragraph: 3,
                        source: "æ¥æº: æ·±åº¦å­¦ä¹ åŸç†.pdf, ç»“è®ºéƒ¨åˆ†",
                        confidence: 0.90,
                        citations: 1780,
                        tags: ["æ·±åº¦å­¦ä¹ ", "å‘å±•è¶‹åŠ¿", "æœªæ¥å±•æœ›"],
                        quotes: [
                            "æ·±åº¦å­¦ä¹ æ˜¯AIå‘å±•çš„é‡è¦é©±åŠ¨åŠ›"
                        ]
                    }
                ]
            },
            {
                question: "æ·±åº¦å­¦ä¹ æ˜¯ä»€ä¹ˆ?",
                files: [
                    {
                        id: 6,
                        name: "æ·±åº¦å­¦ä¹ åŸºç¡€.pdf",
                        type: "pdf",
                        relevance: 0.98,
                        matchScore: 9.8,
                        description: "ç³»ç»Ÿä»‹ç»æ·±åº¦å­¦ä¹ çš„åŸºæœ¬åŸç†ã€ç¥ç»ç½‘ç»œç»“æ„å’Œè®­ç»ƒæ–¹æ³•ã€‚",
                        keywords: ["æ·±åº¦å­¦ä¹ ", "ç¥ç»ç½‘ç»œ", "æ¢¯åº¦ä¸‹é™", "æ¿€æ´»å‡½æ•°"],
                        summary: [
                            "æ·±åº¦å­¦ä¹ çš„å®šä¹‰å’Œå‘å±•å†ç¨‹",
                            "å‰é¦ˆç¥ç»ç½‘ç»œçš„åŸºæœ¬ç»“æ„",
                            "è®­ç»ƒè¿‡ç¨‹å’Œä¼˜åŒ–æŠ€æœ¯"
                        ],
                        author: "Yann LeCun",
                        year: 2020,
                        pages: 480
                    },
                    {
                        id: 7,
                        name: "å·ç§¯ç¥ç»ç½‘ç»œCNN.docx",
                        type: "docx",
                        relevance: 0.91,
                        matchScore: 9.1,
                        description: "è¯¦ç»†è®²è§£CNNçš„ç»“æ„ã€å·ç§¯å±‚ã€æ± åŒ–å±‚å’Œç»å…¸æ¨¡å‹ã€‚",
                        keywords: ["CNN", "å·ç§¯", "æ± åŒ–", "AlexNet", "ResNet"],
                        summary: [
                            "å·ç§¯æ“ä½œçš„æ•°å­¦åŸç†",
                            "ç»å…¸CNNæ¶æ„è§£æ",
                            "å›¾åƒè¯†åˆ«ä»»åŠ¡å®æˆ˜"
                        ],
                        author: "Geoffrey Hinton",
                        year: 2019,
                        pages: 320
                    },
                    {
                        id: 8,
                        name: "åå‘ä¼ æ’­ç®—æ³•.pdf",
                        type: "pdf",
                        relevance: 0.85,
                        matchScore: 8.5,
                        description: "æ·±å…¥è§£æåå‘ä¼ æ’­ç®—æ³•çš„æ•°å­¦åŸç†å’Œå®ç°ç»†èŠ‚ã€‚",
                        keywords: ["åå‘ä¼ æ’­", "é“¾å¼æ³•åˆ™", "æ¢¯åº¦", "ä¼˜åŒ–"],
                        summary: [
                            "æ¢¯åº¦è®¡ç®—çš„æ•°å­¦åŸºç¡€",
                            "é“¾å¼æ³•åˆ™çš„åº”ç”¨",
                            "å¸¸è§ä¼˜åŒ–ç®—æ³•å¯¹æ¯”"
                        ],
                        author: "David Rumelhart",
                        year: 2018,
                        pages: 180
                    },
                    {
                        id: 9,
                        name: "TensorFlowå®æˆ˜.docx",
                        type: "docx",
                        relevance: 0.79,
                        matchScore: 7.9,
                        description: "ä½¿ç”¨TensorFlowæ¡†æ¶æ„å»ºæ·±åº¦å­¦ä¹ æ¨¡å‹çš„å®è·µæŒ‡å—ã€‚",
                        keywords: ["TensorFlow", "Keras", "å®æˆ˜", "éƒ¨ç½²"],
                        summary: [
                            "TensorFlowæ¡†æ¶åŸºç¡€",
                            "æ¨¡å‹æ„å»ºå’Œè®­ç»ƒ",
                            "æ¨¡å‹éƒ¨ç½²å’Œä¼˜åŒ–"
                        ],
                        author: "Google Brain Team",
                        year: 2022,
                        pages: 420
                    },
                    {
                        id: 10,
                        name: "æ·±åº¦å­¦ä¹ åº”ç”¨æ¡ˆä¾‹.pdf",
                        type: "pdf",
                        relevance: 0.72,
                        matchScore: 7.2,
                        description: "æ”¶é›†äº†å›¾åƒåˆ†ç±»ã€ç›®æ ‡æ£€æµ‹ã€è¯­éŸ³è¯†åˆ«ç­‰é¢†åŸŸçš„å®é™…åº”ç”¨æ¡ˆä¾‹ã€‚",
                        keywords: ["åº”ç”¨æ¡ˆä¾‹", "å›¾åƒè¯†åˆ«", "ç›®æ ‡æ£€æµ‹", "è¯­éŸ³è¯†åˆ«"],
                        summary: [
                            "ImageNetç«èµ›å†å¹´å† å†›æ–¹æ¡ˆ",
                            "è‡ªåŠ¨é©¾é©¶ä¸­çš„è§†è§‰ç³»ç»Ÿ",
                            "è¯­éŸ³åŠ©æ‰‹çš„æŠ€æœ¯å®ç°"
                        ],
                        author: "Various Authors",
                        year: 2021,
                        pages: 560
                    }
                ],
                answer: `# æ·±åº¦å­¦ä¹ è¯¦è§£

æ·±åº¦å­¦ä¹ (Deep Learning)æ˜¯æœºå™¨å­¦ä¹ çš„ä¸€ä¸ªå­é¢†åŸŸ,åŸºäºäººå·¥ç¥ç»ç½‘ç»œ,ç‰¹åˆ«æ˜¯æ·±å±‚ç¥ç»ç½‘ç»œè¿›è¡Œå­¦ä¹ ã€‚

## åŸºæœ¬åŸç†

æ·±åº¦å­¦ä¹ é€šè¿‡æ„å»ºå¤šå±‚ç¥ç»ç½‘ç»œ,è‡ªåŠ¨å­¦ä¹ æ•°æ®çš„å±‚æ¬¡åŒ–ç‰¹å¾è¡¨ç¤ºã€‚æ¯ä¸€å±‚éƒ½èƒ½å­¦ä¹ åˆ°ä¸åŒæŠ½è±¡çº§åˆ«çš„ç‰¹å¾ã€‚

## æ ¸å¿ƒæŠ€æœ¯

1. **ç¥ç»ç½‘ç»œ** - æ¨¡æ‹Ÿäººè„‘ç¥ç»å…ƒçš„è¿æ¥æ–¹å¼
2. **åå‘ä¼ æ’­** - é«˜æ•ˆçš„å‚æ•°ä¼˜åŒ–ç®—æ³•
3. **æ¿€æ´»å‡½æ•°** - ReLUã€Sigmoidã€Tanhç­‰
4. **æ­£åˆ™åŒ–æŠ€æœ¯** - Dropoutã€æ‰¹å½’ä¸€åŒ–ç­‰

## å…¸å‹æ¶æ„

- **å·ç§¯ç¥ç»ç½‘ç»œ(CNN)** - ä¸»è¦ç”¨äºå›¾åƒå¤„ç†
- **å¾ªç¯ç¥ç»ç½‘ç»œ(RNN)** - é€‚åˆåºåˆ—æ•°æ®å¤„ç†
- **Transformer** - ç°ä»£NLPçš„åŸºçŸ³

æ·±åº¦å­¦ä¹ åœ¨å›¾åƒè¯†åˆ«ã€è¯­éŸ³è¯†åˆ«ã€è‡ªç„¶è¯­è¨€å¤„ç†ç­‰é¢†åŸŸå–å¾—äº†çªç ´æ€§è¿›å±•ã€‚`,
                answerSources: [
                    {
                        paragraph: 0,
                        source: "æ¥æº: æ·±åº¦å­¦ä¹ åŸºç¡€.pdf, ç¬¬1ç« å¯¼è®º",
                        confidence: 0.98,
                        citations: 3200,
                        tags: ["æ·±åº¦å­¦ä¹ ", "ç¥ç»ç½‘ç»œ", "å®šä¹‰"],
                        quotes: [
                            "æ·±åº¦å­¦ä¹ é€šè¿‡å¤šå±‚ç½‘ç»œå­¦ä¹ æ•°æ®è¡¨ç¤º",
                            "ç‰¹å¾å­¦ä¹ æ˜¯æ·±åº¦å­¦ä¹ çš„æ ¸å¿ƒä¼˜åŠ¿"
                        ],
                        url: "#"
                    },
                    {
                        paragraph: 1,
                        source: "æ¥æº: æ·±åº¦å­¦ä¹ åŸºç¡€.pdf, ç¬¬2-3ç« ",
                        confidence: 0.96,
                        citations: 2890,
                        tags: ["åŸç†", "å±‚æ¬¡åŒ–ç‰¹å¾"],
                        quotes: [
                            "æ¯ä¸€å±‚å­¦ä¹ ä¸åŒæŠ½è±¡çº§åˆ«çš„ç‰¹å¾"
                        ]
                    },
                    {
                        paragraph: 2,
                        source: "æ¥æº: åå‘ä¼ æ’­ç®—æ³•.pdf, ç¬¬4ç« ; æ·±åº¦å­¦ä¹ åŸºç¡€.pdf, ç¬¬5ç« ",
                        confidence: 0.94,
                        citations: 4120,
                        tags: ["åå‘ä¼ æ’­", "æ¿€æ´»å‡½æ•°", "ä¼˜åŒ–ç®—æ³•"],
                        quotes: [
                            "åå‘ä¼ æ’­æ˜¯è®­ç»ƒç¥ç»ç½‘ç»œçš„æ ¸å¿ƒç®—æ³•",
                            "ReLUæ¿€æ´»å‡½æ•°è§£å†³äº†æ¢¯åº¦æ¶ˆå¤±é—®é¢˜",
                            "Dropoutæœ‰æ•ˆé˜²æ­¢è¿‡æ‹Ÿåˆ"
                        ],
                        url: "#"
                    },
                    {
                        paragraph: 3,
                        source: "æ¥æº: å·ç§¯ç¥ç»ç½‘ç»œCNN.docx; TensorFlowå®æˆ˜.docx, ç¬¬7ç« ",
                        confidence: 0.93,
                        citations: 5600,
                        tags: ["CNN", "RNN", "Transformer", "æ¶æ„"],
                        quotes: [
                            "CNNåœ¨å›¾åƒé¢†åŸŸè¡¨ç°å“è¶Š",
                            "Transformeræ¶æ„å¼•é¢†NLPæ–°æ—¶ä»£"
                        ],
                        url: "#"
                    }
                ]
            },
            {
                question: "æœºå™¨å­¦ä¹ æœ‰å“ªäº›ç±»å‹?",
                files: [
                    {
                        id: 11,
                        name: "æœºå™¨å­¦ä¹ æ¦‚è®º.pdf",
                        type: "pdf",
                        relevance: 0.96,
                        description: "å…¨é¢ä»‹ç»æœºå™¨å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µã€ç®—æ³•åˆ†ç±»å’Œç†è®ºåŸºç¡€ã€‚"
                    },
                    {
                        id: 12,
                        name: "ç›‘ç£å­¦ä¹ ç®—æ³•.docx",
                        type: "docx",
                        relevance: 0.89,
                        description: "è¯¦ç»†è®²è§£çº¿æ€§å›å½’ã€é€»è¾‘å›å½’ã€å†³ç­–æ ‘ç­‰ç›‘ç£å­¦ä¹ ç®—æ³•ã€‚"
                    },
                    {
                        id: 13,
                        name: "æ— ç›‘ç£å­¦ä¹ æ–¹æ³•.pdf",
                        type: "pdf",
                        relevance: 0.88,
                        description: "ä»‹ç»èšç±»ã€é™ç»´ã€å¼‚å¸¸æ£€æµ‹ç­‰æ— ç›‘ç£å­¦ä¹ æŠ€æœ¯ã€‚"
                    },
                    {
                        id: 14,
                        name: "å¼ºåŒ–å­¦ä¹ å…¥é—¨.docx",
                        type: "docx",
                        relevance: 0.84,
                        description: "è®²è§£å¼ºåŒ–å­¦ä¹ çš„åŸºæœ¬æ¦‚å¿µã€é©¬å°”å¯å¤«å†³ç­–è¿‡ç¨‹å’ŒQ-learningç®—æ³•ã€‚"
                    },
                    {
                        id: 15,
                        name: "é›†æˆå­¦ä¹ æŠ€æœ¯.pdf",
                        type: "pdf",
                        relevance: 0.76,
                        description: "æ¢è®¨Baggingã€Boostingå’ŒStackingç­‰é›†æˆå­¦ä¹ æ–¹æ³•ã€‚"
                    }
                ],
                answer: `# æœºå™¨å­¦ä¹ çš„ç±»å‹

æœºå™¨å­¦ä¹ æ ¹æ®å­¦ä¹ æ–¹å¼å’Œä»»åŠ¡ç‰¹ç‚¹,å¯ä»¥åˆ†ä¸ºä»¥ä¸‹å‡ ç§ä¸»è¦ç±»å‹:

## 1. ç›‘ç£å­¦ä¹  (Supervised Learning)

ä½¿ç”¨å·²æ ‡è®°çš„è®­ç»ƒæ•°æ®è¿›è¡Œå­¦ä¹ ,å­¦ä¹ è¾“å…¥åˆ°è¾“å‡ºçš„æ˜ å°„å…³ç³»ã€‚
- åˆ†ç±»ä»»åŠ¡: åƒåœ¾é‚®ä»¶æ£€æµ‹ã€å›¾åƒåˆ†ç±»
- å›å½’ä»»åŠ¡: æˆ¿ä»·é¢„æµ‹ã€è‚¡ç¥¨é¢„æµ‹

## 2. æ— ç›‘ç£å­¦ä¹  (Unsupervised Learning)

ä»æœªæ ‡è®°çš„æ•°æ®ä¸­å‘ç°éšè—çš„æ¨¡å¼å’Œç»“æ„ã€‚
- èšç±»: å®¢æˆ·åˆ†ç¾¤ã€å›¾åƒåˆ†å‰²
- é™ç»´: ç‰¹å¾æå–ã€æ•°æ®å¯è§†åŒ–
- å¼‚å¸¸æ£€æµ‹: æ¬ºè¯ˆæ£€æµ‹ã€è®¾å¤‡æ•…éšœé¢„è­¦

## 3. å¼ºåŒ–å­¦ä¹  (Reinforcement Learning)

é€šè¿‡ä¸ç¯å¢ƒäº¤äº’,é€šè¿‡è¯•é”™å­¦ä¹ æœ€ä¼˜ç­–ç•¥ã€‚
- æ¸¸æˆAI: AlphaGoã€ç”µå­æ¸¸æˆ
- æœºå™¨äººæ§åˆ¶: è‡ªåŠ¨é©¾é©¶ã€å·¥ä¸šæœºå™¨äºº
- èµ„æºä¼˜åŒ–: æ¨èç³»ç»Ÿã€å¹¿å‘ŠæŠ•æ”¾

## 4. åŠç›‘ç£å­¦ä¹ 

ç»“åˆå°‘é‡æ ‡è®°æ•°æ®å’Œå¤§é‡æœªæ ‡è®°æ•°æ®è¿›è¡Œå­¦ä¹ ,å¹³è¡¡æˆæœ¬å’Œæ€§èƒ½ã€‚

ä¸åŒç±»å‹çš„æœºå™¨å­¦ä¹ é€‚ç”¨äºä¸åŒçš„åœºæ™¯,é€‰æ‹©åˆé€‚çš„æ–¹æ³•æ˜¯æˆåŠŸçš„å…³é”®ã€‚`,
                answerSources: [
                    {
                        paragraph: 0,
                        source: "æ¥æº: æœºå™¨å­¦ä¹ æ¦‚è®º.pdf, ç¬¬2ç« ",
                        confidence: 0.96,
                        citations: 2100,
                        tags: ["æœºå™¨å­¦ä¹ ", "åˆ†ç±»", "æ¦‚è¿°"],
                        quotes: [
                            "æœºå™¨å­¦ä¹ åˆ†ä¸ºç›‘ç£ã€æ— ç›‘ç£å’Œå¼ºåŒ–å­¦ä¹ ä¸‰å¤§ç±»"
                        ]
                    },
                    {
                        paragraph: 1,
                        source: "æ¥æº: ç›‘ç£å­¦ä¹ ç®—æ³•.docx, ç¬¬1-3ç« ",
                        confidence: 0.94,
                        citations: 1850,
                        tags: ["ç›‘ç£å­¦ä¹ ", "åˆ†ç±»", "å›å½’"],
                        quotes: [
                            "ç›‘ç£å­¦ä¹ éœ€è¦æ ‡è®°æ•°æ®è¿›è¡Œè®­ç»ƒ",
                            "åˆ†ç±»å’Œå›å½’æ˜¯ä¸¤å¤§ä¸»è¦ä»»åŠ¡"
                        ],
                        url: "#"
                    },
                    {
                        paragraph: 2,
                        source: "æ¥æº: æ— ç›‘ç£å­¦ä¹ æ–¹æ³•.pdf, ç¬¬2ã€4ã€6ç« ",
                        confidence: 0.91,
                        citations: 1620,
                        tags: ["æ— ç›‘ç£å­¦ä¹ ", "èšç±»", "é™ç»´"],
                        quotes: [
                            "æ— ç›‘ç£å­¦ä¹ ä»æœªæ ‡è®°æ•°æ®ä¸­å‘ç°æ¨¡å¼",
                            "K-meansæ˜¯æœ€å¸¸ç”¨çš„èšç±»ç®—æ³•",
                            "PCAç”¨äºæ•°æ®é™ç»´å’Œå¯è§†åŒ–"
                        ],
                        url: "#"
                    },
                    {
                        paragraph: 3,
                        source: "æ¥æº: å¼ºåŒ–å­¦ä¹ å…¥é—¨.docx, ç¬¬1ã€5ã€7ç« ",
                        confidence: 0.89,
                        citations: 2450,
                        tags: ["å¼ºåŒ–å­¦ä¹ ", "Q-learning", "ç­–ç•¥ä¼˜åŒ–"],
                        quotes: [
                            "å¼ºåŒ–å­¦ä¹ é€šè¿‡è¯•é”™å­¦ä¹ æœ€ä¼˜ç­–ç•¥",
                            "AlphaGoå±•ç¤ºäº†å¼ºåŒ–å­¦ä¹ çš„å¼ºå¤§èƒ½åŠ›"
                        ],
                        url: "#"
                    },
                    {
                        paragraph: 4,
                        source: "æ¥æº: æœºå™¨å­¦ä¹ æ¦‚è®º.pdf, ç¬¬9ç« ",
                        confidence: 0.92,
                        citations: 980,
                        tags: ["åŠç›‘ç£å­¦ä¹ ", "æ··åˆæ–¹æ³•"],
                        quotes: [
                            "åŠç›‘ç£å­¦ä¹ å¹³è¡¡äº†æ ‡æ³¨æˆæœ¬å’Œæ¨¡å‹æ€§èƒ½"
                        ]
                    }
                ]
            }
        ];

        // ========== Vue åº”ç”¨ ==========
        createApp({
            data() {
                return {
                    messages: [],          // æ¶ˆæ¯åˆ—è¡¨
                    userInput: '',         // ç”¨æˆ·è¾“å…¥
                    isProcessing: false,   // æ˜¯å¦æ­£åœ¨å¤„ç†
                    currentMockIndex: 0,   // å½“å‰ä½¿ç”¨çš„Mockæ•°æ®ç´¢å¼•
                    currentTaskId: null    // å½“å‰ä»»åŠ¡ID(ç”¨äºç»ˆæ­¢)
                };
            },

            methods: {
                // å‘é€æ¶ˆæ¯
                async sendMessage() {
                    const text = this.userInput.trim();
                    if (!text || this.isProcessing) return;

                    // æ·»åŠ ç”¨æˆ·æ¶ˆæ¯
                    this.messages.push({
                        type: 'user',
                        text: text,
                        time: this.getCurrentTime()
                    });

                    // æ¸…ç©ºè¾“å…¥æ¡†
                    this.userInput = '';
                    this.isProcessing = true;

                    // åˆ›å»ºAIæ¶ˆæ¯
                    const aiMessage = {
                        type: 'ai',
                        status: 'searching',  // searching -> files -> thinking -> done
                        files: [],
                        answer: '',
                        answerSources: [],
                        time: this.getCurrentTime()
                    };

                    this.messages.push(aiMessage);

                    // æ»šåŠ¨åˆ°åº•éƒ¨
                    this.$nextTick(() => {
                        this.scrollToBottom();
                    });

                    // æ¨¡æ‹Ÿè·å–æ–‡ä»¶åˆ—è¡¨
                    await this.sleep(CONFIG.MOCK_DELAY);

                    if (!this.isProcessing) return; // å·²ç»ˆæ­¢

                    // è·å–Mockæ•°æ®
                    const mockData = this.getMockData(text);
                    aiMessage.files = mockData.files.map(f => ({ ...f, selected: false }));
                    aiMessage.status = 'files';
                    aiMessage.answer = mockData.answer;
                    aiMessage.answerSources = mockData.answerSources;
                    this.isProcessing = false;  // é‡ç½®å¤„ç†çŠ¶æ€

                    this.$nextTick(() => {
                        this.scrollToBottom();
                    });
                },

                // åˆ‡æ¢æ–‡ä»¶é€‰ä¸­çŠ¶æ€
                toggleFileSelection(file, message) {
                    // åªæœ‰åœ¨ 'files' çŠ¶æ€ä¸‹æ‰èƒ½åˆ‡æ¢
                    if (message.status !== 'files') return;

                    // åˆ‡æ¢é€‰ä¸­çŠ¶æ€
                    file.selected = !file.selected;
                },

                // ç¡®è®¤é€‰æ‹©æ–‡ä»¶
                async confirmFiles(message) {
                    const selectedFiles = message.files.filter(f => f.selected);
                    if (selectedFiles.length === 0) return;

                    // è®¾ç½®å¤„ç†çŠ¶æ€
                    this.isProcessing = true;

                    // å¼€å§‹æ€è€ƒ
                    message.status = 'thinking';
                    this.$nextTick(() => {
                        this.scrollToBottom();
                    });

                    // æ¨¡æ‹Ÿæ€è€ƒè¿‡ç¨‹
                    await this.sleep(CONFIG.MOCK_DELAY);

                    if (!this.isProcessing) return; // å·²ç»ˆæ­¢

                    // æ˜¾ç¤ºç­”æ¡ˆ
                    message.status = 'done';
                    this.isProcessing = false;

                    this.$nextTick(() => {
                        this.scrollToBottom();
                    });
                },

                // ç»ˆæ­¢ä»»åŠ¡
                terminateTask() {
                    this.isProcessing = false;

                    // æ‰¾åˆ°æœ€åä¸€æ¡AIæ¶ˆæ¯
                    for (let i = this.messages.length - 1; i >= 0; i--) {
                        if (this.messages[i].type === 'ai' && this.messages[i].status !== 'done') {
                            this.messages[i].status = 'terminated';
                            this.messages[i].answer = '**ä»»åŠ¡å·²è¢«ç»ˆæ­¢**';
                            break;
                        }
                    }
                },

                // å¯¼å‡ºExcel
                exportToExcel() {
                    alert('å¯¼å‡ºExcelåŠŸèƒ½(å ä½),å®é™…é¡¹ç›®ä¸­å¯ä½¿ç”¨SheetJSç­‰åº“å®ç°');
                },

                // è·å–Mockæ•°æ®
                getMockData(question) {
                    // æ ¹æ®é—®é¢˜å…³é”®è¯åŒ¹é…
                    for (const data of MOCK_DATA) {
                        if (question.includes('æ·±åº¦å­¦ä¹ ') && data.question.includes('æ·±åº¦å­¦ä¹ ')) {
                            return data;
                        }
                        if (question.includes('æœºå™¨å­¦ä¹ ') && data.question.includes('æœºå™¨å­¦ä¹ ')) {
                            return data;
                        }
                    }

                    // é»˜è®¤è¿”å›ç¬¬ä¸€ç»„æ•°æ®,å¹¶å¾ªç¯ä½¿ç”¨
                    const data = MOCK_DATA[this.currentMockIndex % MOCK_DATA.length];
                    this.currentMockIndex++;
                    return data;
                },

                // æ„å»ºæ–‡ä»¶æ‚¬æµ®æç¤ºæ•°æ®
                buildFileTooltipData(file) {
                    const data = {
                        text: file.name,
                        description: file.description,
                        tags: file.keywords,
                        tagsLabel: 'å…³é”®è¯',
                        list: file.summary,
                        listLabel: 'å†…å®¹æ‘˜è¦'
                    };

                    // æ„å»ºç»Ÿè®¡æ•°æ®
                    if (file.relevance || file.matchScore) {
                        data.stats = [];
                        data.statsLabel = 'ç›¸å…³åº¦åˆ†æ';

                        if (file.relevance) {
                            data.stats.push({
                                value: Math.round(file.relevance * 100) + '%',
                                label: 'åŒ¹é…åº¦'
                            });
                        }

                        if (file.matchScore) {
                            data.stats.push({
                                value: file.matchScore,
                                label: 'åŒ¹é…åˆ†æ•°'
                            });
                        }
                    }

                    // æ„å»ºå…ƒæ•°æ®
                    if (file.author || file.year || file.pages) {
                        const parts = [];
                        if (file.author) parts.push(`ä½œè€…: ${file.author}`);
                        if (file.year) parts.push(`å¹´ä»½: ${file.year}`);
                        if (file.pages) parts.push(`é¡µæ•°: ${file.pages}`);
                        data.metadata = parts.join(' | ');
                        data.metadataLabel = 'æ–‡æ¡£ä¿¡æ¯';
                    }

                    return data;
                },

                // åˆ¤æ–­æ˜¯å¦æœ‰é€‰ä¸­çš„æ–‡ä»¶
                hasSelectedFiles(message) {
                    return message.files && message.files.some(f => f.selected);
                },

                // è·å–æ–‡ä»¶å›¾æ ‡
                getFileIcon(type) {
                    const icons = {
                        'pdf': 'ğŸ“•',
                        'docx': 'ğŸ“˜',
                        'doc': 'ğŸ“˜',
                        'txt': 'ğŸ“„'
                    };
                    return icons[type] || 'ğŸ“„';
                },

                // è·å–å½“å‰æ—¶é—´
                getCurrentTime() {
                    const now = new Date();
                    return `${now.getHours().toString().padStart(2, '0')}:${now.getMinutes().toString().padStart(2, '0')}`;
                },

                // æ»šåŠ¨åˆ°åº•éƒ¨
                scrollToBottom() {
                    this.$nextTick(() => {
                        const container = this.$refs.chatContainer;
                        if (container) {
                            container.scrollTop = container.scrollHeight;
                        }
                    });
                },

                // å¤„ç†Shift+Enteræ¢è¡Œ
                handleShiftEnter(event) {
                    // Shift+Enterå·²ç»è‡ªåŠ¨æ¢è¡Œ,ä¸éœ€è¦ç‰¹æ®Šå¤„ç†
                },

                // ç¡çœ å‡½æ•°
                sleep(ms) {
                    return new Promise(resolve => setTimeout(resolve, ms));
                }
            },

            mounted() {
                // é¡µé¢åŠ è½½æ—¶ä¸æ·»åŠ æ¬¢è¿æ¶ˆæ¯ï¼Œä¿æŒå¯¹è¯åŒºåŸŸä¸ºç©º
            },

            components: {
                'tooltip-card': TooltipCard,
                'answer-with-sources': AnswerWithSources
            }
        }).mount('#app');
    </script>
</body>
</html>
